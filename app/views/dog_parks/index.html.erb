<div class="dog-parks index core-window">
  <div class="transparent-bg core-content">
          <div class="title">Dog Parks</div>
    <div class="top">
      <div class="filter-and-new">
        <% if current_user && current_user.primary_address %>
          <%= form_tag(dog_parks_path, method: :get) do %>
            <div class="single-input">
              <%= label_tag 'distance', 'Distance:' %>
              <% selected_distance = params[:distance].present? ? params[:distance] : '25' %>
              <%= select_tag 'distance', options_for_select(['10', '25', '50', '100'], selected: selected_distance) %>
            </div>
            <div class="filter-and-page">
              <%= link_to dog_parks_path, class: 'action-button', data: {turbo_method: :get}, onclick: "this.closest('form').submit(); return false;" do %>
                <button class="filter">  
                  <span class="text">Filter</span>
                  <span class="icon">
                    <svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path d="M14,12V19.88C14.04,20.18 13.94,20.5 13.71,20.71C13.32,21.1 12.69,21.1 12.3,20.71L10.29,18.7C10.06,18.47 9.96,18.16 10,17.87V12H9.97L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3V3H19V3C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L14.03,12H14Z" />
                    </svg>
                  </span>
                </button>
              <% end %>
              <%= render 'shared/pagination', page: @page, total_pages: @total_pages %>
            </div>
          <% end %>
        <% end %>
        <div class="new">
          <%= link_to new_dog_park_path, class: "action-button", method: :get, data: {turbo_method: :get} do %>
            <%= render 'shared/plusbutton', btn_text: 'NEW' %>
          <% end %>
        </div>
      </div>
    </div>
    <hr>
    <div class="list">
      <% @nearby_dog_parks.each do |dog_park| %>
        <div class="dog-park">
          <%= link_to dog_park do %>
            <span class="details"><%= dog_park.name %> - <%= dog_park.address.distance_from(current_user.primary_address).round(1) %> mi </span>
          <% end %>
          <span class="actions">
            <%= link_to dog_park, class: "action-button icon-only", method: :get, data: {turbo_method: :get} do %>
              <button class="view">
                <span class="text">View</span>
                <span class="icon">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black">
                    <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
                  </svg>
                </span>
              </button>
            <% end %>
            <%= turbo_frame_tag "follow-actions-#{dog_park.id}" do %>
              <% if current_user.following?(dog_park) %>
                <%= link_to unfollow_dog_park_path(dog_park), class: "action-button icon-only", method: :delete, data: {turbo_method: :delete} do %>
                  <%= render 'shared/minusbutton', btn_text: 'UNFOLLOW' %>
                <% end %>
              <% else %>
                <%= link_to follow_dog_park_path(dog_park), class: "action-button icon-only", method: :post, data: {turbo_method: :post} do %>
                  <%= render 'shared/plusbutton', btn_text: 'FOLLOW' %>
                <% end %>
              <% end %>
            <% end %>
          </span>
        </div>
      <% end %>
    </div>
  </div>
</div>
